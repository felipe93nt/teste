<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:awb-h="http://bradesco.com.br/components-html"
	xmlns:awb-f="http://bradesco.com.br/components-core"
	xmlns:awb-th="http://bradesco.com.br/components-th-ext"
	xmlns:awb-br="http://bradesco.com.br/components-br"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:presCore="http://bradesco.com.br/presentation_core">

<ui:composition template="/template/root/mainLayout.xhtml">
	<ui:param name="tela" value="1" />
	<ui:param name="selection"
		value="#{faceletsBreadCrumb.getValue('label_questionario_imobiliario')}" />
	<ui:param name="passNumber" value="4" />
	<ui:param name="paginaAnterior"
		value="#{questionarioImobiliarioBean.paginaAnterior}" />
	<ui:param name="pathList"
		value="#{faceletsBreadCrumb.getPathQuestionarioSetor(paginaAnterior, 'label_imobiliario')}" />
	<ui:param name="cur_page" value="#{msgs.header_arq}" />
	<ui:define name="body">
		<ui:include src="/template/contadorSessao.xhtml" />
		<awb-br:stylesheet href="/template/css/components.css" />
		<awb-br:stylesheet href="/template/css/grids.css" />
		<awb-br:stylesheet href="/template/css/modalMessages.css" />
		<awb-br:stylesheet href="/template/css/estilos_calendar.css" />
		<awb-br:stylesheet href="/css/tabelas.css" />
		<awb-br:stylesheet href="/css/pages.css" />
		<awb-br:stylesheet href="/css/componentes.css" />
		<awb-br:stylesheet href="/css/grids.css" />
		<awb-br:stylesheet href="/css/projetotemplate.css" />
		<awb-br:stylesheet href="/css/scrollCentralAbas.css" />
		<awb-br:javascript src="/javascript/util.js" />
		<awb-br:javascript src="/javascript/validacao.js" />
		<awb-br:javascript src="/javascript/setor/imobiliario/imobiliario.js" />

		<awb-h:form id="uploadForm" enctype="multipart/form-data">
			<div style="display: none">
				<awb-h:panelGrid columns="2" style="float: right">
					<awb-br:fileUpload id="cpFileUpload"
						value="#{questionarioImobiliarioBean.file}"
						allowedTypes="TXT,EXE,DLL,RAR,ZIP,JAR,PDF,DOC,DOCX,PPT,PPS,XLS,XLSX,XLSM,JPG,GIF,PNG,HTML,MP3,WAV,MID,AVI,MPG,MKV,OGG,MP4,WMV,MOV,PSD,CDR,XML,CSS,PHP,ASP,ASPX,FLV,TAR,JSP,CFM,JS,SVG,TIF,FLA,SWF,DWG,SQL,CBL,CPY,JCL,B1,BAT,VB,AI,DBF,MDB"
						fileSizeMax="10485760" required="false">
					</awb-br:fileUpload>
					<awb-h:commandButton id="btnUpload"
						styleClass="HtmlCommandButtonBradesco2"
						value="#{msgs.label_upload_xls}" title="#{msgs.label_upload_xls}"
						style="margin-right:35px"
						action="#{questionarioImobiliarioBean.upload}">
					</awb-h:commandButton>
					<awb-h:messages></awb-h:messages>
				</awb-h:panelGrid>
			</div>
		</awb-h:form>

		<awb-h:form id="questionarioImobiliarioForm">

			<script type="text/javascript">
				window.onload = function() {
					bloquearUpload();
					carregarDadosQuestionario();
					carregarDadosAndamento();
					carregarDadosConcluidas();
				}
			</script>

			<awb-h:panelGrid cellpadding="0" cellspacing="0"
				styleClass="linhaPrincipal" />

			<awb-h:panelGrid columns="3" style="float: right">
				<awb-h:inputText id="txtUpload" disabled="true" size="50" />
				<awb-h:commandButton id="btnSelecionar"
					styleClass="HtmlCommandButtonBradesco2"
					onclick="acionarFileUpload();" value="#{msgs.label_selecionar_xls}"
					title="#{msgs.label_selecionar_xls}">
					<f:ajax render="btnUploadVisible" />
				</awb-h:commandButton>
				<awb-h:commandButton id="btnUploadVisible"
					value="#{msgs.label_upload_xls}" title="#{msgs.label_upload_xls}"
					styleClass="HtmlCommandButtonBradesco2" onclick="acionarUpload();">
					<f:ajax render="questionarioImobiliarioForm" onevent="aguarde" />
				</awb-h:commandButton>
			</awb-h:panelGrid>

			<!-- INICIO - Dados de Grupo e Relatório -->
			<awb-h:panelGrid columns="3">
				<awb-h:outputLabel value="#{msgs.label_grupo}:"
					styleClass="HtmlOutputLabelBradesco" style="width:40px;" />
				<awb-h:panelGroup>
					<awb-h:outputLabel id="codGrupo"
						value="#{questionarioImobiliarioBean.viewHelper.questionarioImobiliarioVO.codGrupoEconomico} - "
						styleClass="HtmlOutputLabelBoldBradesco" />
					<awb-h:outputLabel id="descGrupo"
						value="#{questionarioImobiliarioBean.viewHelper.questionarioImobiliarioVO.descGrupoEconomico}"
						styleClass="HtmlOutputLabelBoldBradesco" />
				</awb-h:panelGroup>
			</awb-h:panelGrid>

			<awb-h:panelGrid columns="2">
				<awb-h:outputLabel value="Código de Controle: "
					styleClass="HtmlOutputLabelBradesco" />
				<awb-h:outputLabel id="codRelatorio"
					value="#{questionarioImobiliarioBean.viewHelper.questionarioImobiliarioVO.codRelatorio}"
					styleClass="HtmlOutputLabelBoldBradesco" />
			</awb-h:panelGrid>
			<!-- FIM - Dados de Grupo e Relatório -->

			<awb-h:panelGrid width="100%">
				<presCore:forceSkin segmento="IB" guia="" skin="">
					<awb-br:tabs id="tabs">

						<awb-br:tab id="tab1" selected="true">
							<!-- binding="#{questionarioImobiliarioBean.tabQuestionario}"> -->
							<awb-f:facet name="header">
								<awb-h:outputFormat value="Questionário"
									styleClass="HtmlOutputFormatBoldBradesco" />
							</awb-f:facet>

							<!--ABA QUESTIONARIO-->
							<ui:include src="questionarioImobiliarioQuestionario.xhtml" />
						</awb-br:tab>

						<awb-br:tab id="tab2">
							<!-- binding="#{questionarioImobiliarioBean.tabObrasAndamento}"> -->
							<awb-f:facet name="header">
								<awb-h:outputFormat value="Obras em Andamento"
									styleClass="HtmlOutputFormatBoldBradesco" />
							</awb-f:facet>

							<!--ABA OBRAS EM ANDAMENTO-->
							<ui:include src="questionarioImobiliarioObrasAndamento.xhtml" />
						</awb-br:tab>

						<awb-br:tab id="tab3">
							<!-- binding="#{questionarioImobiliarioBean.tabObrasConcluidas}"> -->
							<awb-f:facet name="header">
								<awb-h:outputFormat value="Obras Concluídas"
									styleClass="HtmlOutputFormatBoldBradesco" />
							</awb-f:facet>

							<!--ABA OBRAS CONCLUÍDAS-->
							<ui:include src="questionarioImobiliarioObrasConcluidas.xhtml" />
						</awb-br:tab>

					</awb-br:tabs>
				</presCore:forceSkin>
			</awb-h:panelGrid>

			<awb-h:inputHidden id="abaSelecionada"
				value="#{questionarioImobiliarioBean.abaSelecionada}" />

			<awb-h:panelGrid cellpadding="0" cellspacing="0"
				styleClass="linhaPrincipal" />
			<awb-h:panelGrid columns="2" cellpadding="0" cellspacing="0"
				border="0" styleClass="gridBotao">
				<awb-h:panelGrid columns="1" styleClass="gridBotaoEsquerda">
					<awb-h:commandButton id="btnVoltar"
						action="#{questionarioImobiliarioBean.voltar}" immediate="true"
						value="#{msgs.label_voltar}" style=""
						styleClass="HtmlCommandButtonBradesco2" />
				</awb-h:panelGrid>
				<awb-h:panelGrid columns="1" styleClass="gridBotaoDireita">
					<awb-h:panelGroup>
						<awb-h:commandButton id="btnSalvarQuest"
							action="#{questionarioImobiliarioBean.salvar}"
							value="#{msgs.label_salvar}" style="margin-right:5px;"
							styleClass="HtmlCommandButtonBradesco2">
							<f:ajax execute="@form" render="formModalMessages"
								onevent="aguarde" />
						</awb-h:commandButton>
					</awb-h:panelGroup>
				</awb-h:panelGrid>
			</awb-h:panelGrid>

			<h:outputScript>
				var tab1 = document.getElementById('questionarioImobiliarioForm:tab1-tab-title');
				var tab2 = document.getElementById('questionarioImobiliarioForm:tab2-tab-title');
				var tab3 = document.getElementById('questionarioImobiliarioForm:tab3-tab-title');
				
				tab1.addEventListener("click", selecionaQuestionario);
				tab2.addEventListener("click", selecionaObrasAndamento);
				tab3.addEventListener("click", selecionaObrasConcluidas);

				function selecionaQuestionario() {
				  document.getElementById('questionarioImobiliarioForm:abaSelecionada').value = 'questionario';
				}
				
				function selecionaObrasAndamento() {
					document.getElementById('questionarioImobiliarioForm:abaSelecionada').value = 'obrasAndamento';
				}
				
				function selecionaObrasConcluidas() {
					document.getElementById('questionarioImobiliarioForm:abaSelecionada').value = 'obrasConcluidas';
				}

				function acionarFileUpload(){
					document.getElementById('uploadForm:cpFileUpload_file').click();
					
					var conteudo = document.getElementById('uploadForm:cpFileUpload_text');
					
					if(conteudo.value == ""){
						bloquearUpload();
						document.getElementById('questionarioImobiliarioForm').reload();				
					}else{
						document.getElementById('questionarioImobiliarioForm:btnUploadVisible').disabled=false;
						document.getElementById('questionarioImobiliarioForm:txtUpload').value = conteudo.value;
					}
				}
				
				function acionarUpload(){
					document.getElementById('uploadForm:btnUpload').click();
					bloquearUpload();
				}
				
				function bloquearUpload(){
					document.getElementById('questionarioImobiliarioForm:btnUploadVisible').disabled=true;
				}
			</h:outputScript>

		</awb-h:form>

	</ui:define>
</ui:composition>

</html>